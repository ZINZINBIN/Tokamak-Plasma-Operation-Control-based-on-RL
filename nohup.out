torch device avaliable :  True
torch current device :  0
torch device num :  4
extract the null data:   0%|          | 0/620 [00:00<?, ?it/s]extract the null data:  10%|▉         | 60/620 [00:00<00:00, 594.96it/s]extract the null data:  19%|█▉        | 120/620 [00:00<00:00, 549.79it/s]extract the null data:  30%|██▉       | 183/620 [00:00<00:00, 583.80it/s]extract the null data:  40%|████      | 249/620 [00:00<00:00, 612.80it/s]extract the null data:  51%|█████     | 315/620 [00:00<00:00, 629.20it/s]extract the null data:  62%|██████▏   | 382/620 [00:00<00:00, 641.82it/s]extract the null data:  72%|███████▏  | 447/620 [00:00<00:00, 636.56it/s]extract the null data:  82%|████████▏ | 511/620 [00:00<00:00, 616.59it/s]extract the null data:  93%|█████████▎| 577/620 [00:00<00:00, 629.58it/s]extract the null data: 100%|██████████| 620/620 [00:00<00:00, 621.85it/s]
Dataset preprocessing...:   0%|          | 0/620 [00:00<?, ?it/s]Dataset preprocessing...:   3%|▎         | 17/620 [00:00<00:03, 159.83it/s]Dataset preprocessing...:   5%|▌         | 33/620 [00:00<00:06, 87.43it/s] Dataset preprocessing...:   7%|▋         | 44/620 [00:00<00:07, 76.61it/s]Dataset preprocessing...:   9%|▊         | 53/620 [00:00<00:07, 73.40it/s]Dataset preprocessing...:  10%|▉         | 61/620 [00:00<00:08, 66.82it/s]Dataset preprocessing...:  11%|█         | 68/620 [00:00<00:09, 59.55it/s]Dataset preprocessing...:  12%|█▏        | 76/620 [00:01<00:08, 61.58it/s]Dataset preprocessing...:  13%|█▎        | 83/620 [00:01<00:09, 55.85it/s]Dataset preprocessing...:  15%|█▍        | 90/620 [00:01<00:09, 57.17it/s]Dataset preprocessing...:  15%|█▌        | 96/620 [00:01<00:09, 53.52it/s]Dataset preprocessing...:  17%|█▋        | 105/620 [00:01<00:08, 61.21it/s]Dataset preprocessing...:  18%|█▊        | 112/620 [00:01<00:08, 59.85it/s]Dataset preprocessing...:  20%|█▉        | 122/620 [00:01<00:07, 68.12it/s]Dataset preprocessing...:  21%|██        | 130/620 [00:01<00:07, 69.17it/s]Dataset preprocessing...:  22%|██▏       | 138/620 [00:02<00:07, 67.09it/s]Dataset preprocessing...:  23%|██▎       | 145/620 [00:02<00:07, 66.67it/s]Dataset preprocessing...:  25%|██▍       | 153/620 [00:02<00:07, 64.37it/s]Dataset preprocessing...:  26%|██▌       | 161/620 [00:02<00:06, 67.35it/s]Dataset preprocessing...:  27%|██▋       | 168/620 [00:02<00:07, 57.88it/s]Dataset preprocessing...:  29%|██▉       | 181/620 [00:02<00:05, 74.64it/s]Dataset preprocessing...:  31%|███       | 190/620 [00:02<00:05, 77.59it/s]Dataset preprocessing...:  32%|███▏      | 199/620 [00:02<00:05, 80.63it/s]Dataset preprocessing...:  34%|███▎      | 208/620 [00:03<00:05, 77.29it/s]Dataset preprocessing...:  35%|███▍      | 216/620 [00:03<00:05, 73.92it/s]Dataset preprocessing...:  36%|███▌      | 224/620 [00:03<00:05, 72.10it/s]Dataset preprocessing...:  38%|███▊      | 233/620 [00:03<00:05, 75.12it/s]Dataset preprocessing...:  39%|███▉      | 241/620 [00:03<00:05, 72.89it/s]Dataset preprocessing...:  40%|████      | 249/620 [00:03<00:05, 70.20it/s]Dataset preprocessing...:  41%|████▏     | 257/620 [00:03<00:05, 64.08it/s]Dataset preprocessing...:  43%|████▎     | 264/620 [00:03<00:05, 60.48it/s]Dataset preprocessing...:  44%|████▎     | 271/620 [00:04<00:06, 57.64it/s]Dataset preprocessing...:  45%|████▍     | 278/620 [00:04<00:05, 60.27it/s]Dataset preprocessing...:  46%|████▌     | 285/620 [00:04<00:05, 57.64it/s]Dataset preprocessing...:  47%|████▋     | 293/620 [00:04<00:05, 62.10it/s]Dataset preprocessing...:  48%|████▊     | 300/620 [00:04<00:08, 38.32it/s]Dataset preprocessing...:  50%|█████     | 310/620 [00:04<00:06, 47.68it/s]Dataset preprocessing...:  51%|█████▏    | 318/620 [00:04<00:05, 51.86it/s]Dataset preprocessing...:  52%|█████▏    | 325/620 [00:05<00:07, 37.51it/s]Dataset preprocessing...:  54%|█████▎    | 332/620 [00:05<00:06, 42.36it/s]Dataset preprocessing...:  55%|█████▌    | 341/620 [00:05<00:05, 48.82it/s]Dataset preprocessing...:  56%|█████▌    | 347/620 [00:05<00:05, 49.30it/s]Dataset preprocessing...:  57%|█████▋    | 354/620 [00:05<00:05, 52.20it/s]Dataset preprocessing...:  58%|█████▊    | 360/620 [00:05<00:04, 53.84it/s]Dataset preprocessing...:  59%|█████▉    | 367/620 [00:05<00:04, 56.83it/s]Dataset preprocessing...:  60%|██████    | 375/620 [00:06<00:03, 62.31it/s]Dataset preprocessing...:  62%|██████▏   | 382/620 [00:06<00:03, 63.87it/s]Dataset preprocessing...:  63%|██████▎   | 389/620 [00:06<00:03, 63.80it/s]Dataset preprocessing...:  64%|██████▍   | 397/620 [00:06<00:03, 67.26it/s]Dataset preprocessing...:  65%|██████▌   | 404/620 [00:06<00:03, 57.97it/s]Dataset preprocessing...:  66%|██████▋   | 411/620 [00:06<00:03, 59.93it/s]Dataset preprocessing...:  67%|██████▋   | 418/620 [00:06<00:03, 55.71it/s]Dataset preprocessing...:  69%|██████▉   | 427/620 [00:06<00:03, 64.14it/s]Dataset preprocessing...:  70%|███████   | 434/620 [00:07<00:02, 64.12it/s]Dataset preprocessing...:  71%|███████▏  | 442/620 [00:07<00:02, 67.70it/s]Dataset preprocessing...:  72%|███████▏  | 449/620 [00:07<00:03, 55.09it/s]Dataset preprocessing...:  73%|███████▎  | 455/620 [00:07<00:03, 53.54it/s]Dataset preprocessing...:  75%|███████▍  | 462/620 [00:07<00:02, 54.37it/s]Dataset preprocessing...:  76%|███████▌  | 470/620 [00:07<00:02, 59.99it/s]Dataset preprocessing...:  77%|███████▋  | 477/620 [00:07<00:02, 55.30it/s]Dataset preprocessing...:  78%|███████▊  | 483/620 [00:08<00:02, 46.73it/s]Dataset preprocessing...:  79%|███████▉  | 489/620 [00:08<00:02, 45.90it/s]Dataset preprocessing...:  80%|███████▉  | 495/620 [00:08<00:02, 47.41it/s]Dataset preprocessing...:  81%|████████▏ | 504/620 [00:08<00:02, 55.08it/s]Dataset preprocessing...:  83%|████████▎ | 513/620 [00:08<00:01, 62.36it/s]Dataset preprocessing...:  84%|████████▍ | 521/620 [00:08<00:01, 65.99it/s]Dataset preprocessing...:  85%|████████▌ | 528/620 [00:08<00:01, 62.92it/s]Dataset preprocessing...:  86%|████████▋ | 535/620 [00:08<00:01, 64.46it/s]Dataset preprocessing...:  87%|████████▋ | 542/620 [00:08<00:01, 63.01it/s]Dataset preprocessing...:  89%|████████▊ | 549/620 [00:09<00:01, 62.52it/s]Dataset preprocessing...:  90%|████████▉ | 556/620 [00:09<00:01, 52.74it/s]Dataset preprocessing...:  91%|█████████ | 562/620 [00:09<00:01, 51.40it/s]Dataset preprocessing...:  92%|█████████▏| 568/620 [00:09<00:01, 49.74it/s]Dataset preprocessing...:  93%|█████████▎| 574/620 [00:09<00:00, 51.90it/s]Dataset preprocessing...:  94%|█████████▎| 580/620 [00:09<00:00, 50.30it/s]Dataset preprocessing...:  95%|█████████▍| 587/620 [00:09<00:00, 53.86it/s]Dataset preprocessing...:  96%|█████████▌| 593/620 [00:09<00:00, 47.98it/s]Dataset preprocessing...:  96%|█████████▋| 598/620 [00:10<00:00, 37.79it/s]Dataset preprocessing...:  98%|█████████▊| 606/620 [00:10<00:00, 45.99it/s]Dataset preprocessing...:  99%|█████████▊| 612/620 [00:10<00:00, 42.80it/s]Dataset preprocessing...: 100%|█████████▉| 619/620 [00:10<00:00, 34.48it/s]Dataset preprocessing...: 100%|██████████| 620/620 [00:10<00:00, 56.57it/s]
extract the null data:   0%|          | 0/155 [00:00<?, ?it/s]extract the null data:  38%|███▊      | 59/155 [00:00<00:00, 589.49it/s]extract the null data:  88%|████████▊ | 137/155 [00:00<00:00, 697.38it/s]extract the null data: 100%|██████████| 155/155 [00:00<00:00, 693.32it/s]
Dataset preprocessing...:   0%|          | 0/155 [00:00<?, ?it/s]Dataset preprocessing...:   6%|▌         | 9/155 [00:00<00:01, 85.65it/s]Dataset preprocessing...:  12%|█▏        | 18/155 [00:00<00:02, 59.18it/s]Dataset preprocessing...:  16%|█▌        | 25/155 [00:00<00:02, 58.80it/s]Dataset preprocessing...:  21%|██▏       | 33/155 [00:00<00:01, 64.97it/s]Dataset preprocessing...:  26%|██▌       | 40/155 [00:00<00:01, 65.27it/s]Dataset preprocessing...:  33%|███▎      | 51/155 [00:00<00:01, 75.71it/s]Dataset preprocessing...:  38%|███▊      | 59/155 [00:00<00:01, 75.28it/s]Dataset preprocessing...:  43%|████▎     | 67/155 [00:00<00:01, 73.61it/s]Dataset preprocessing...:  48%|████▊     | 75/155 [00:01<00:01, 69.02it/s]Dataset preprocessing...:  54%|█████▎    | 83/155 [00:01<00:01, 70.99it/s]Dataset preprocessing...:  59%|█████▊    | 91/155 [00:01<00:00, 73.23it/s]Dataset preprocessing...:  64%|██████▍   | 99/155 [00:01<00:00, 73.99it/s]Dataset preprocessing...:  69%|██████▉   | 107/155 [00:01<00:00, 64.17it/s]Dataset preprocessing...:  74%|███████▎  | 114/155 [00:01<00:00, 60.62it/s]Dataset preprocessing...:  78%|███████▊  | 121/155 [00:01<00:00, 54.14it/s]Dataset preprocessing...:  83%|████████▎ | 129/155 [00:01<00:00, 58.93it/s]Dataset preprocessing...:  88%|████████▊ | 136/155 [00:02<00:00, 57.87it/s]Dataset preprocessing...:  92%|█████████▏| 142/155 [00:02<00:00, 57.20it/s]Dataset preprocessing...:  95%|█████████▌| 148/155 [00:02<00:00, 55.35it/s]Dataset preprocessing...: 100%|██████████| 155/155 [00:02<00:00, 64.07it/s]
extract the null data:   0%|          | 0/194 [00:00<?, ?it/s]extract the null data:  31%|███▏      | 61/194 [00:00<00:00, 604.43it/s]extract the null data:  68%|██████▊   | 132/194 [00:00<00:00, 661.35it/s]extract the null data: 100%|██████████| 194/194 [00:00<00:00, 677.07it/s]
Dataset preprocessing...:   0%|          | 0/194 [00:00<?, ?it/s]Dataset preprocessing...:   3%|▎         | 6/194 [00:00<00:03, 56.88it/s]Dataset preprocessing...:   6%|▌         | 12/194 [00:00<00:03, 58.58it/s]Dataset preprocessing...:  10%|▉         | 19/194 [00:00<00:03, 58.29it/s]Dataset preprocessing...:  13%|█▎        | 25/194 [00:00<00:02, 57.23it/s]Dataset preprocessing...:  16%|█▋        | 32/194 [00:00<00:02, 59.85it/s]Dataset preprocessing...:  20%|█▉        | 38/194 [00:00<00:02, 59.02it/s]Dataset preprocessing...:  26%|██▌       | 50/194 [00:00<00:01, 75.67it/s]Dataset preprocessing...:  31%|███       | 60/194 [00:00<00:01, 81.18it/s]Dataset preprocessing...:  36%|███▌      | 69/194 [00:00<00:01, 79.61it/s]Dataset preprocessing...:  40%|███▉      | 77/194 [00:01<00:01, 78.02it/s]Dataset preprocessing...:  44%|████▍     | 85/194 [00:01<00:01, 76.48it/s]Dataset preprocessing...:  48%|████▊     | 93/194 [00:01<00:01, 66.61it/s]Dataset preprocessing...:  52%|█████▏    | 100/194 [00:01<00:01, 63.27it/s]Dataset preprocessing...:  55%|█████▌    | 107/194 [00:01<00:01, 63.41it/s]Dataset preprocessing...:  59%|█████▉    | 114/194 [00:01<00:01, 46.52it/s]Dataset preprocessing...:  62%|██████▏   | 121/194 [00:01<00:01, 50.73it/s]Dataset preprocessing...:  65%|██████▌   | 127/194 [00:02<00:01, 42.58it/s]Dataset preprocessing...:  68%|██████▊   | 132/194 [00:02<00:01, 44.07it/s]Dataset preprocessing...:  72%|███████▏  | 140/194 [00:02<00:01, 52.23it/s]Dataset preprocessing...:  76%|███████▌  | 147/194 [00:02<00:00, 56.15it/s]Dataset preprocessing...:  79%|███████▉  | 154/194 [00:02<00:00, 54.99it/s]Dataset preprocessing...:  82%|████████▏ | 160/194 [00:02<00:00, 55.70it/s]Dataset preprocessing...:  87%|████████▋ | 168/194 [00:02<00:00, 61.57it/s]Dataset preprocessing...:  90%|█████████ | 175/194 [00:02<00:00, 63.22it/s]Dataset preprocessing...:  94%|█████████▍| 182/194 [00:03<00:00, 61.17it/s]Dataset preprocessing...:  97%|█████████▋| 189/194 [00:03<00:00, 54.22it/s]Dataset preprocessing...: 100%|██████████| 194/194 [00:03<00:00, 56.97it/s]
train data :  71404
valid data :  16010
test data :  23937
-----------------------------------------------------------------------------------
           Layer (type)                Input Shape         Param #     Tr. Param #
===================================================================================
           NoiseLayer-1                [1, 21, 24]               0               0
               Linear-2                [1, 21, 24]           3,200           3,200
   PositionalEncoding-3               [21, 1, 128]               0               0
   TransformerEncoder-4     [21, 1, 128], [21, 21]         793,088         793,088
               Linear-5                  [1, 2688]       1,032,576       1,032,576
               Linear-6                [1, 3, 128]           8,256           8,256
            LayerNorm-7                 [1, 3, 64]             128             128
                 ReLU-8                 [1, 3, 64]               0               0
               Linear-9                 [1, 3, 64]           4,160           4,160
           LayerNorm-10                 [1, 3, 64]             128             128
                ReLU-11                 [1, 3, 64]               0               0
              Linear-12                 [1, 3, 64]             650             650
===================================================================================
Total params: 1,842,186
Trainable params: 1,842,186
Non-trainable params: 0
Batch size: 1
-----------------------------------------------------------------------------------
training process:   0%|          | 0/32 [00:00<?, ?it/s]training process:   3%|▎         | 1/32 [03:31<1:49:23, 211.72s/it]epoch : 1, train loss : 19.867, valid loss : 15.604,
training process:   6%|▋         | 2/32 [07:14<1:49:02, 218.09s/it]training process:   9%|▉         | 3/32 [10:48<1:44:35, 216.41s/it]training process:  12%|█▎        | 4/32 [14:33<1:42:27, 219.57s/it]training process:  16%|█▌        | 5/32 [18:05<1:37:38, 216.98s/it]epoch : 5, train loss : 11.433, valid loss : 10.772,
training process:  19%|█▉        | 6/32 [21:51<1:35:20, 220.02s/it]training process:  22%|██▏       | 7/32 [25:24<1:30:45, 217.81s/it]training process:  25%|██▌       | 8/32 [29:12<1:28:26, 221.11s/it]training process:  28%|██▊       | 9/32 [32:48<1:24:05, 219.37s/it]epoch : 9, train loss : 9.279, valid loss : 8.936,
training process:  31%|███▏      | 10/32 [36:14<1:18:54, 215.19s/it]training process:  34%|███▍      | 11/32 [39:37<1:14:03, 211.58s/it]training process:  38%|███▊      | 12/32 [43:01<1:09:45, 209.27s/it]training process:  41%|████      | 13/32 [46:27<1:05:56, 208.25s/it]epoch : 13, train loss : 7.995, valid loss : 8.003,
training process:  44%|████▍     | 14/32 [49:53<1:02:14, 207.45s/it]training process:  47%|████▋     | 15/32 [53:19<58:39, 207.02s/it]  training process:  50%|█████     | 16/32 [56:50<55:33, 208.33s/it]training process:  53%|█████▎    | 17/32 [1:00:44<53:59, 215.94s/it]epoch : 17, train loss : 7.397, valid loss : 7.505,
training process:  56%|█████▋    | 18/32 [1:04:49<52:28, 224.93s/it]training process:  59%|█████▉    | 19/32 [1:08:55<50:06, 231.26s/it]training process:  62%|██████▎   | 20/32 [1:13:02<47:11, 235.97s/it]training process:  66%|██████▌   | 21/32 [1:17:08<43:47, 238.83s/it]epoch : 21, train loss : 6.923, valid loss : 7.998,
training process:  69%|██████▉   | 22/32 [1:21:15<40:12, 241.24s/it]training process:  72%|███████▏  | 23/32 [1:25:21<36:24, 242.70s/it]training process:  75%|███████▌  | 24/32 [1:29:27<32:29, 243.67s/it]training process:  78%|███████▊  | 25/32 [1:33:28<28:19, 242.84s/it]epoch : 25, train loss : 6.669, valid loss : 6.925,
training process:  81%|████████▏ | 26/32 [1:37:35<24:24, 244.12s/it]training process:  84%|████████▍ | 27/32 [1:41:41<20:24, 244.86s/it]training process:  88%|████████▊ | 28/32 [1:45:48<16:20, 245.23s/it]training process:  91%|█████████ | 29/32 [1:49:46<12:09, 243.10s/it]epoch : 29, train loss : 6.365, valid loss : 6.757,
training process:  94%|█████████▍| 30/32 [1:53:18<07:47, 233.98s/it]training process:  97%|█████████▋| 31/32 [1:57:06<03:52, 232.14s/it]training process: 100%|██████████| 32/32 [2:00:42<00:00, 227.37s/it]training process: 100%|██████████| 32/32 [2:00:42<00:00, 226.34s/it]
training process finished, best loss : 6.402, best epoch : 30
test loss : 16.879
# mse : 0.194, rmse : 0.372, mae : 0.102
